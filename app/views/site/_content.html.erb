<% @data["data"].each_with_index do |data,i| %>
  <div class="grid_6 omega">
    <div class="image-contain">
      <a href="/media/<%= data["id"] %>">
        <% if data["type"] == "video" %>
          <video width="97%" controls>
            <source src="<%= data["videos"]["standard_resolution"]["url"] %>" type="video/mp4">
          </video>
        <% else %>
          <img src="<%= data["images"]["standard_resolution"]["url"] %>" style="width:97%" >
        <% end %>
      </a>
    </div>
    <% if data["type"] == "image" %>
      <div class="des-bar">
        <% if @current_user.present? && !@current_user.guest_user %>
          <% if data['user_has_liked'] %>
            <div class="foundicongen-heart red"></div>
          <% else %>
            <i class="foundicongen-heart white" id="<%= data['id'] %>" data-pos="<%= i %>" data-likes="<%= data["likes"]["count"] %>"></i>
          <% end %>    
        <% end %>
        <div class="bar-font" id="bar-font-<%= data['id'] %>" like-count="<%= data["likes"]["count"] %>"><%= data["comments"]["count"]  %> Comments <span><%= data["likes"]["count"] %></span> Likes</div>
      </div>
    <% end %>
  </div>
<% end %>

<script type="text/javascript">
  $(document).ready(function(){
    $(".white").click(function(){
      var mediaId = this.id;
      likeCount = parseInt($('#'+mediaId).attr('data-likes'))+1;
      $('#'+mediaId).addClass('red');
      $('#'+mediaId).removeClass('white');
      $('#bar-font-'+mediaId+' span').text(likeCount);

      $.ajax({
        url: "/like-media",
        type: 'POST',
        data: {"media_id" : mediaId},
        success: function(response) {
          console.log("phew!!!!");
        }
      });
    });

  });
</script>